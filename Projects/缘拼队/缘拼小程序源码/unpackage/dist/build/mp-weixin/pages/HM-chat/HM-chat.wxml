<view><view data-event-opts="{{[['touchstart',[['hideDrawer',['$event']]]]]}}" class="content" bindtouchstart="__e"><scroll-view class="msg-list" scroll-y="true" scroll-with-animation="{{scrollAnimation}}" scroll-top="{{scrollTop}}" scroll-into-view="{{scrollToView}}" upper-threshold="50" data-event-opts="{{[['scrolltoupper',[['loadHistory',['$event']]]]]}}" bindscrolltoupper="__e"><block wx:if="{{isHistoryLoading}}"><view class="loading"><view class="spinner"><view class="rect1"></view><view class="rect2"></view><view class="rect3"></view><view class="rect4"></view><view class="rect5"></view></view></view></block><block wx:for="{{msgList}}" wx:for-item="row" wx:for-index="key" wx:key="key"><view class="row" id="{{row.messageUId}}"><block wx:if="{{row.messageType=='system'}}"><block><view class="system"><block wx:if="{{row.type=='time'}}"><view class="text">{{''+row.content+''}}</view></block></view></block></block><block wx:if="{{row.messageType=='getPin'}}"><block><view class="system"><view data-event-opts="{{[['tap',[['pin',['$event']]]]]}}" class="text" style="color:#30C6B0;background-color:#FFFFFF;" bindtap="__e">{{''+row.content+''}}</view></view></block></block><block wx:if="{{row.content.extra.type=='system'}}"><block><view class="system"><view class="text">{{''+row.content.extra.content+''}}</view></view></block></block><block><block wx:if="{{row.senderUserId==myId&&row.content.extra.type!='system'}}"><view class="my"><view class="left"><block wx:if="{{row.messageType=='TextMessage'&&row.content.extra.type!='pin'&&row.content.extra.type!='system'}}"><view class="bubble" style="max-height:5000rpx;"><rich-text nodes="{{row.content.extra}}"></rich-text></view></block><block wx:if="{{row.content.type=='mp3'}}"><view data-event-opts="{{[['tap',[['playVoice',['$0'],[[['msgList','',key]]]]]]]}}" class="{{['bubble voice',playMsgid==row.messageUId?'play':'']}}" bindtap="__e"><view class="length">{{row.content.name}}</view><view class="icon my-voice"></view></view></block><block wx:if="{{row.messageType=='ImageMessage'}}"><view class="bubble img"><image src="{{row.content.imageUri}}" mode="widthFix" data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgList','',key,'content']]]]]]]}}" bindtap="__e"></image></view></block><block wx:if="{{row.content.extra.type=='pin'}}"><block><view class="pinByMe"><text>您发起了ta标题为</text><text style="color:#30C6B0;">{{row.content.extra.title}}</text><text>的缘拼请求</text></view></block></block></view><view class="right"><image src="{{myAvatarUrl}}"></image></view></view></block><block wx:if="{{row.senderUserId==targetId&&row.content.extra.type!='system'}}"><view class="other"><view class="left"><image src="{{avatarUrl}}" data-event-opts="{{[['tap',[['jump',['friend']]]]]}}" bindtap="__e"></image></view><view class="right"><view class="username"><view class="name">{{uName}}</view><view class="time">{{row.msg.time}}</view></view><block wx:if="{{row.messageType=='TextMessage'&&row.content.extra.type!='pin'&&row.content.extra.type!='system'}}"><view class="bubble" style="max-height:5000rpx;"><rich-text nodes="{{row.content.extra}}"></rich-text></view></block><block wx:if="{{row.content.type=='mp3'}}"><view data-event-opts="{{[['tap',[['playVoice',['$0'],[[['msgList','',key]]]]]]]}}" class="{{['bubble voice',playMsgid==row.messageUId?'play':'']}}" bindtap="__e"><view class="icon other-voice"></view><view class="length">{{row.content.name}}</view></view></block><block wx:if="{{row.messageType=='ImageMessage'}}"><view class="bubble img"><image src="{{row.content.imageUri}}" mode="widthFix" data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgList','',key,'content']]]]]]]}}" bindtap="__e"></image></view></block><block wx:if="{{row.content.extra.type=='pin'}}"><block><view class="pinByYou"><view class="pin-title"><block wx:if="{{row.senderUserId!=myId}}"><text>{{uName+"想参与您标题为"}}</text></block><text style="color:#30C6B0;">{{row.content.extra.title}}</text><text>的缘拼</text></view><view class="yesOrNo"><view data-event-opts="{{[['tap',[['disagree',['$event']]]]]}}" class="no" bindtap="__e">拒绝</view><view data-event-opts="{{[['tap',[['agree',['$0'],[[['msgList','',key,'content.extra.id']]]]]]]}}" class="yes" bindtap="__e">同意</view></view></view></block></block></view></view></block></block></view></block></scroll-view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['popup-layer',popupLayerClass]}}" catchtouchmove="__e"><swiper class="{{['emoji-swiper',(hideEmoji)?'hidden':'']}}" indicator-dots="true" duration="150"><block wx:for="{{emojiList}}" wx:for-item="page" wx:for-index="pid" wx:key="pid"><swiper-item><block wx:for="{{page}}" wx:for-item="em" wx:for-index="eid" wx:key="eid"><view data-event-opts="{{[['tap',[['addEmoji',['$0'],[[['emojiList','',pid],['','',eid]]]]]]]}}" bindtap="__e"><image mode="widthFix" src="{{'https://zmetalhearty.com/yuanpin/emoji/'+em.url}}"></image></view></block></swiper-item></block></swiper><view class="{{['more-layer',(hideMore)?'hidden':'']}}"><view class="list"><view data-event-opts="{{[['tap',[['chooseImage',['$event']]]]]}}" class="box" bindtap="__e"><view class="icon tupian2"></view></view><view data-event-opts="{{[['tap',[['camera',['$event']]]]]}}" class="box" bindtap="__e"><view class="icon paizhao"></view></view><view data-event-opts="{{[['tap',[['pin',['$event']]]]]}}" class="box" bindtap="__e"><image style="width:70rpx;height:70rpx;" src="../../static/icon/拼.png" mode></image></view></view></view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['input-box',popupLayerClass]}}" catchtouchmove="__e"><view class="voice"><view data-event-opts="{{[['tap',[['switchVoice',['$event']]]]]}}" class="{{['icon',isVoice?'jianpan':'yuyin']}}" bindtap="__e"></view></view><view class="textbox"><view data-event-opts="{{[['touchstart',[['voiceBegin',['$event']]]],['touchmove',[['voiceIng',['$event']]]],['touchend',[['voiceEnd',['$event']]]],['touchcancel',[['voiceCancel',['$event']]]]]}}" class="{{['voice-mode',isVoice?'':'hidden',recording?'recording':'']}}" bindtouchstart="__e" catchtouchmove="__e" bindtouchend="__e" bindtouchcancel="__e">{{voiceTis}}</view><view class="{{['text-mode',isVoice?'hidden':'']}}"><view class="box"><textarea style="max-height:200rpx;" focus="{{getFocus}}" show-confirm-bar="false" hold-keyboard="true" auto-height="true" cursor-spacing="{{space==0?100:0}}" maxlength="-1" data-event-opts="{{[['input',[['__set_model',['','textMsg','$event',[]]],['spaceStatus',['$event']]]],['confirm',[['sendText',['$event']]]],['focus',[['textareaFocus',['$event']]]]]}}" value="{{textMsg}}" bindinput="__e" bindconfirm="__e" bindfocus="__e"></textarea></view><view data-event-opts="{{[['tap',[['chooseEmoji',['$event']]]]]}}" class="em" bindtap="__e"><view class="icon biaoqing"></view></view></view></view><view data-event-opts="{{[['tap',[['showMore',['$event']]]]]}}" class="more" bindtap="__e"><view class="icon add"></view></view><view data-event-opts="{{[['tap',[['sendText',['$event']]]]]}}" class="{{['send',isVoice?'hidden':'']}}" bindtap="__e"><view class="btn">发送</view></view></view><view class="{{['record',recording?'':'hidden']}}"><view class="{{['ing',willStop?'hidden':'']}}"><view class="icon luyin2"></view></view><view class="{{['cancel',willStop?'':'hidden']}}"><view class="icon chehui"></view></view><view class="{{['tis',willStop?'change':'']}}">{{recordTis}}</view></view><uni-popup class="vue-ref" style="z-index:999;" vue-id="127596be-1" type="center" data-ref="popup" bind:__l="__l" vue-slots="{{['default']}}"><view class="pop-title">ta的缘拼</view><block wx:if="{{sendEmpty}}"><view class="empty">ta还没有发布过缘拼呢~</view></block><block wx:if="{{!sendEmpty}}"><scroll-view class="pop" scroll-y="true"><block wx:for="{{$root.l0}}" wx:for-item="view" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['choose',['$0'],[[['sendArray','',index]]]]]]]}}" class="viewBox" bindtap="__e"><view class="view-title"><view class="title-text">{{''+view.$orig.title+''}}</view><view class="title-time">{{''+view.$orig.date+" "+view.$orig.time+''}}</view></view><view class="view-content">{{''+view.$orig.details+''}}</view><view class="{{[view.$orig.type=='travel'?'location':'location1']}}"><view class="{{[view.$orig.type=='travel'?'view-location':'view-location1']}}"><view class="location-left"><block wx:if="{{view.$orig.type=='travel'}}"><image style="width:34rpx;height:34rpx;" src="../../static/image/-departure.png" mode></image></block><block wx:if="{{view.$orig.type!='travel'}}"><image src="../../static/icon/address.png" mode></image></block></view><view class="{{[view.$orig.type=='travel'?'location-right':'location-right1']}}"><block wx:if="{{view.$orig.type=='travel'}}"><text>{{view.$orig.pstart.name}}</text></block><block wx:if="{{view.$orig.type!='travel'}}"><text>{{view.$orig.address.name}}</text></block></view></view><block wx:if="{{view.$orig.type=='travel'}}"><view class="view-location"><view class="location-left"><image style="width:34rpx;height:34rpx;" src="../../static/image/-landing.png" mode></image></view><view class="location-right"><block wx:if="{{view.$orig.type=='travel'}}"><text>{{view.$orig.pend.name}}</text></block></view></view></block></view><view class="view-user"><view class="user-left"><image src="{{view.$orig.Userimg}}" mode></image><view class="name-type"><text class="name">{{view.$orig.nickname}}</text><view class="{{[view.$orig.type=='food'?'food':view.$orig.type=='travel'?'travel':view.$orig.type=='study'?'study':view.$orig.type=='game'?'game':'none']}}"><block wx:if="{{view.$orig.type=='food'}}"><text class="food-text">拼美食</text></block><block wx:if="{{view.$orig.type=='travel'}}"><text class="travel-text">拼出行</text></block><block wx:if="{{view.$orig.type=='study'}}"><text class="study-text">拼学习</text></block><block wx:if="{{view.$orig.type=='game'}}"><text class="game-text">拼娱乐</text></block></view></view></view><view class="user-right"><image src="../../static/icon/like.png" mode id="like"></image><text>{{view.$orig.likeCount}}</text><image src="../../static/icon/comment.png" id="comment" mode></image><text>{{view.g0.length}}</text></view></view></view></block></scroll-view></block><view class="pop-bottom" hover-class="pop-bottom-hover" data-event-opts="{{[['tap',[['hidePop',['$event']]]]]}}" bindtap="__e">取  消</view></uni-popup></view>